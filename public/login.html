<!DOCTYPE html>

<html>
    <head>
        <title>Presentation application</title>
        <link rel="stylesheet" href="css/stylelog.css"/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <script src="superfetch2.js"></script>
    </head>

    <body>
        <div class="login-page">
            <div class="form">
                <h1 id="title-regis">Presentation Application Account</h1>
                <form class="login-form">
                    <input id="username" type="text" placeholder="username"/>
                    <input id="password" type="password" placeholder="password"/>
                    <button onClick="login()">login</button>
                    <p class="message">Not registered? <a href="signup.html">Create an account</a></p>
                </form>
            </div>
        </div>
    </body>
    
    <script>
        
        //button click ---------------------------------
        
        function login() {
            var username = document.getElementById("username");
            var password = document.getElementById("password");
            console.log(username.value);
            console.log(password.value);
            if (username.value != "" && password.value != "") {

                var upload = JSON.stringify({
                    loginname:username.value, 
                    password:password.value
                });
                console.log(upload);
                var url = "http://localhost:8080/api/users/auth/";

                var cfg = {
                    method: "POST",            
                    body: upload,
                    headers:{
                                "content-type":"application/json"
                            }
                    
                }
                console.log(url);
                superfetch(url, "json", succ, error, cfg);
            }
            else
            {
                alert("A required field is empty");
            }
        }
        
        //success --------------------------------------
        function succ(data) {

            console.log(data);
            console.log("Suce ma bite");
            //save logindata/token to localStorage 
            localStorage.setItem("logindata", JSON.stringify(data));
        }
        
        //error ----------------------------------------
        function error(err) {
            console.log("heyhey7");
            console.log(err);
            alert(err);
        }
        
    </script>
</html>

