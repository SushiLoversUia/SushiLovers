<!DOCTYPE html>

<html>
    <head>
        <title>Sign up!</title>
        <link rel="stylesheet" href="css/stylelog.css"/>
        <meta charset="utf-8"/>
        <script src="superfetch2.js"></script>
    </head>

    <body>
        <div class="login-page">
            <div class="form">
                <h1 id="title-regis">Presentation Application Account</h1>
                    <input id="username" type="text" placeholder="Username"/>
                    <input id="password" type="password" placeholder="Password"/>
                    <input id="fstname" type="text" placeholder="First name"/>
                    <input id="lstname" type="text" placeholder="Last name"/>
                    <input id="email" type="text" placeholder="email address" onkeypress="isItEnter(event)"/>
                    <button onClick="createUser()">create</button>
                    <p class="message">Already registered? <a href="index.html">Sign In</a></p>
            </div>
        </div>
    </body>
    
    <script>
        
        //isItEnter : function to login the user if he press enter on the field input password
        function isItEnter(e) {
            if(e.keyCode == 13)
                createUser();
            return;
        }
        //button click ---------------------------------
        function createUser() {
            var username = document.getElementById("username");
            var password = document.getElementById("password");
            var fstname = document.getElementById("fstname");
            var lstname = document.getElementById("lstname");
            var email = document.getElementById("email");

            if (username.value != "" && password.value != "" && fstname.value != "" && lstname.value != "" && email.value != "") {

                var upload = JSON.stringify({
                    loginname:username.value, 
                    password:password.value,
                    fstname:fstname.value,
                    lstname: lstname.value,
                    email:email.value
                });

                var url = "https://app-presentation-sushi-lovers.herokuapp.com/api/users";

                var cfg = {
                    method: "POST",            
                    body: upload,
                }
                
                superfetch(url, "json", succ, error, cfg);
            }
            else
            {
                alert("A required field is empty");
            }
        }
        //success --------------------------------------
        function succ(data) {
            console.log(data);
            //save logindata/token to localStorage 
            localStorage.setItem("logindata", JSON.stringify(data));
        }
        //error ----------------------------------------
        function error(err) {
            console.log(err);
        }
        
    </script>
</html>



